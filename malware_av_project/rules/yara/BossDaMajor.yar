import "pe"
rule BossDaMajor {
    strings:
        $s1 = "CreateFileA" wide ascii
        $s2 = "ShellExecuteExA" wide ascii
        $s3 = "CreateProcess" wide ascii
        $s4= "PathQuoteSpacesA" wide ascii
        $s5 = "PathAddBackslashA" wide ascii
        $s6 = "BitBlt" wide ascii
        $s7 = "VirtualAlloc" wide ascii
        $s8= "memset" wide ascii
        $s9 = "stack overflow" wide ascii
    
    condition:
        uint16(0) == 0x5A4D and  // PE文件头
        pe.imports("SHLWAPI.dll") and
        pe.imports("KERNEL32.dll") and
        6 of them
}