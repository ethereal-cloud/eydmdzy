import "pe"
rule yhzll{

    strings:
        $s1 = "waveOutOpen" wide ascii nocase
        $s2 = "DrawDibDraw" wide ascii nocase
        $s3 = "AVIStreamInfoA" wide ascii nocase
        $s4 = "WS2_32.dll" wide ascii
        $s5 = "inflate 1.1.3" wide ascii
        $s6 = "Copyright 1995-1998 Mark Adler" wide ascii
        $s7 = "CreateFileA" wide ascii

    condition:
        uint16(0) == 0x5A4D and  // PE文件头
        pe.imports("WINMM.dll") and
        pe.imports("MSVFW32.dll") and
        pe.imports("WS2_32.dll") and
        6 of them
}