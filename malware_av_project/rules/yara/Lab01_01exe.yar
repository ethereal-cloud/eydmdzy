rule Lab1_1exe
 {
    strings:
        $mz = { 4D 5A }
        $target_dll = "Lab01-01.dll"
        $fake_dll = "kerne132.dll" 
        $system_path = "C:\\windows\\system32\\kerne132.dll" 
        $find_first = "FindFirstFileA" 
        $find_next = "FindNextFileA"
        $copy_file = "CopyFileA" 
        $create_file = "CreateFileA" 
    condition:
        $mz at 0 and
        all of ($target_dll, $fake_dll, $system_path,$find_first, $find_next, $copy_file, $create_file)
}
