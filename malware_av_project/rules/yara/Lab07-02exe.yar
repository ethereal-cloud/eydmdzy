rule Lab07_02
{
    meta:
        description = "file Lab07-02"
        author = "Malwareaqqq"
        date = "2025-12-16"

    strings:
        $string_1 = "_controlfp" ascii
        $string_2 = "__setusermatherr" ascii

        $fun_1 = "OleUninitialize" ascii
        $fun_2 = "CoCreateInstance" ascii
        $fun_3 = "OleInitialize" ascii

        $dll_1 = "MSVCRT.dll" nocase ascii
        $dll_2 = "OLEAUT32.dll" nocase ascii
        $dll_3 = "ole32.dll" nocase ascii

    condition:
        filesize < 100KB and
        uint16(0) == 0x5A4D and
        uint32(uint32(0x3C)) == 0x00004550 and
        all of them
}
