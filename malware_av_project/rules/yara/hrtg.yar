import "pe"
rule hrtg {
strings:
        $s1 = "RegSetValueExA" wide ascii
        $s2 = "RegOpenKeyExA" wide ascii
        $s3 = "SetWindowsHookExA" wide ascii
        $s4 = "GetMessage" wide ascii
        $s5 = "WS2_32.dll" wide ascii
        $s6 = "socket" wide ascii
        $s7 = "stack overflow" wide ascii
        $s8 = "SHBrowseForFolder" wide ascii
    
    condition:
        uint16(0) == 0x5A4D and  
        pe.number_of_sections >= 3 and
        pe.imports("ADVAPI32.dll") and
        pe.imports("USER32.dll") and
        4 of them
}